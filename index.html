<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YouTube Parallel - Đa nhiệm song song</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --yt-red: #ff0000;
            --yt-black: #0f0f0f;
            --yt-dark-grey: #272727;
        }

        body {
            background-color: var(--yt-black);
            color: white;
            font-family: 'Roboto', sans-serif;
            overflow-x: hidden;
        }

        .glass-header {
            background: rgba(15, 15, 15, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #333;
        }

        .search-box:focus-within {
            border-color: #3ea6ff;
            box-shadow: 0 0 8px rgba(62, 166, 255, 0.3);
        }

        .video-card {
            transition: all 0.2s ease;
        }

        .video-card:active {
            transform: scale(0.96);
        }

        #mini-player {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: none;
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .shimmer {
            background: linear-gradient(90deg, #1a1a1a 25%, #2a2a2a 50%, #1a1a1a 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
    </style>
</head>
<body class="pb-24">

    <!-- HEADER -->
    <header class="fixed top-0 w-full h-16 glass-header flex items-center justify-between px-4 z-[100]">
        <div class="flex items-center gap-1">
            <i data-lucide="layers" class="text-red-600 w-7 h-7"></i>
            <span class="text-xl font-bold tracking-tighter">Parallel</span>
        </div>

        <div class="flex-1 max-w-[600px] mx-4">
            <div class="search-box flex items-center bg-[#121212] border border-[#333] rounded-full px-4 py-2 transition">
                <input type="text" id="masterSearch" placeholder="Dán link YouTube hoặc tìm kiếm..." class="flex-1 bg-transparent outline-none text-sm text-white">
                <button onclick="handleSearch()"><i data-lucide="search" class="w-5 h-5 text-gray-400"></i></button>
            </div>
        </div>

        <div class="flex items-center gap-3">
            <button onclick="toggleLayout()" class="p-2 hover:bg-[#333] rounded-full">
                <i data-lucide="layout-grid" class="w-5 h-5"></i>
            </button>
            <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full"></div>
        </div>
    </header>

    <!-- CONTENT AREA -->
    <main class="mt-20 px-4">
        <!-- Tab Switcher -->
        <div class="flex gap-3 mb-6 overflow-x-auto no-scrollbar py-2">
            <button class="bg-white text-black px-4 py-1.5 rounded-lg text-sm font-medium">Khám phá</button>
            <button class="bg-[#272727] px-4 py-1.5 rounded-lg text-sm font-medium">Đang thịnh hành</button>
            <button class="bg-[#272727] px-4 py-1.5 rounded-lg text-sm font-medium">Nhạc</button>
            <button class="bg-[#272727] px-4 py-1.5 rounded-lg text-sm font-medium">Gaming</button>
            <button class="bg-[#272727] px-4 py-1.5 rounded-lg text-sm font-medium">Live</button>
        </div>

        <!-- Video Grid -->
        <div id="mainGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- Dữ liệu mẫu sẽ render ở đây -->
        </div>
    </main>

    <!-- FLOATING MULTI-PLAYER -->
    <div id="mini-player" class="fixed bottom-20 right-4 w-[320px] bg-[#1a1a1a] rounded-2xl overflow-hidden shadow-2xl border border-[#333] z-[200]">
        <div class="relative aspect-video bg-black">
            <div id="videoContainer" class="w-full h-full">
                <!-- Iframe hoặc Video Tag sẽ nhảy vào đây -->
            </div>
            <button onclick="closeMiniPlayer()" class="absolute top-2 right-2 p-1 bg-black/50 rounded-full hover:bg-red-600 transition">
                <i data-lucide="x" class="w-4 h-4"></i>
            </button>
        </div>
        <div class="p-3">
            <h3 id="miniTitle" class="text-sm font-bold truncate">Đang phát song song...</h3>
            <div class="flex items-center justify-between mt-2">
                <p class="text-[10px] text-gray-400">Chế độ chạy nền đang bật</p>
                <button onclick="requestPiP()" class="text-blue-400 text-[10px] font-bold">BẬT PIP</button>
            </div>
        </div>
    </div>

    <!-- BOTTOM NAV -->
    <nav class="fixed bottom-0 w-full h-16 bg-[#0f0f0f] border-t border-[#222] flex items-center justify-around z-[150]">
        <div class="flex flex-col items-center text-white"><i data-lucide="home"></i><span class="text-[10px] mt-1">Trang chủ</span></div>
        <div class="flex flex-col items-center text-gray-400"><i data-lucide="compass"></i><span class="text-[10px] mt-1">Khám phá</span></div>
        <div class="flex flex-col items-center text-gray-400"><i data-lucide="play-square"></i><span class="text-[10px] mt-1">Đã đăng ký</span></div>
        <div class="flex flex-col items-center text-gray-400"><i data-lucide="user"></i><span class="text-[10px] mt-1">Bạn</span></div>
    </nav>

    <script>
        lucide.createIcons();

        const sampleVideos = [
            { id: 'video1', title: 'Hướng dẫn lướt sóng song song với YouTube', author: 'Parallel Tech', views: '120K', time: '2 giờ trước', thumb: 'https://picsum.photos/seed/p1/400/225', type: 'local', url: 'https://vjs.zencdn.net/v/oceans.mp4' },
            { id: 'video2', title: 'Top 10 mẹo đa nhiệm trên điện thoại', author: 'Mobile Pro', views: '450K', time: '1 ngày trước', thumb: 'https://picsum.photos/seed/p2/400/225', type: 'local', url: 'https://www.w3schools.com/html/mov_bbb.mp4' },
            { id: 'video3', title: 'Âm nhạc Lofi cho ngày làm việc', author: 'Chill Beats', views: '2M', time: '3 ngày trước', thumb: 'https://picsum.photos/seed/p3/400/225', type: 'local', url: 'https://www.w3schools.com/html/movie.mp4' },
            { id: 'video4', title: 'Review iPhone 15 Pro Max Parallel', author: 'Duy Thẩm Clone', views: '300K', time: '5 giờ trước', thumb: 'https://picsum.photos/seed/p4/400/225', type: 'local', url: 'https://vjs.zencdn.net/v/oceans.mp4' }
        ];

        function renderGrid(data) {
            const grid = document.getElementById('mainGrid');
            grid.innerHTML = data.map(v => `
                <div class="video-card cursor-pointer" onclick="playParallel('${v.url}', '${v.title}', '${v.type}')">
                    <div class="relative aspect-video rounded-xl overflow-hidden bg-[#222]">
                        <img src="${v.thumb}" class="w-full h-full object-cover">
                        <div class="absolute bottom-2 right-2 bg-black/80 px-1 rounded text-[10px]">10:00</div>
                    </div>
                    <div class="flex gap-3 mt-3">
                        <div class="w-10 h-10 rounded-full bg-gray-700 flex-shrink-0"></div>
                        <div>
                            <h3 class="text-sm font-bold line-clamp-2">${v.title}</h3>
                            <p class="text-xs text-gray-400 mt-1">${v.author}</p>
                            <p class="text-xs text-gray-400">${v.views} lượt xem • ${v.time}</p>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function handleSearch() {
            const val = document.getElementById('masterSearch').value;
            if (val.includes('youtube.com') || val.includes('youtu.be')) {
                // Xử lý link YouTube thực tế
                let videoId = '';
                if (val.includes('v=')) videoId = val.split('v=')[1].split('&')[0];
                else videoId = val.split('/').pop();
                
                const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
                playParallel(embedUrl, "YouTube Video (Parallel)", "youtube");
            } else {
                // Search giả lập
                const filtered = sampleVideos.filter(v => v.title.toLowerCase().includes(val.toLowerCase()));
                renderGrid(filtered);
            }
        }

        function playParallel(url, title, type) {
            const player = document.getElementById('mini-player');
            const container = document.getElementById('videoContainer');
            const titleEl = document.getElementById('miniTitle');

            player.style.display = 'block';
            titleEl.innerText = title;

            if (type === 'youtube') {
                container.innerHTML = `<iframe src="${url}" class="w-full h-full" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>`;
            } else {
                container.innerHTML = `<video id="activeVideo" src="${url}" class="w-full h-full" controls autoplay playsinline></video>`;
            }
        }

        function closeMiniPlayer() {
            const player = document.getElementById('mini-player');
            const container = document.getElementById('videoContainer');
            player.style.display = 'none';
            container.innerHTML = '';
        }

        async function requestPiP() {
            const video = document.getElementById('activeVideo');
            if (video && document.pictureInPictureEnabled) {
                await video.requestPictureInPicture();
            } else {
                alert("YouTube Iframe không cho phép PiP trực tiếp, hãy dùng link video MP4 để thử tính năng này!");
            }
        }

        // Khởi tạo
        renderGrid(sampleVideos);
    </script>
</body>
</html>

